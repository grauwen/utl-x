# Data Contract - E-commerce Order Events
# Based on datacontract.com specification
# Defines contract for order processing event stream
dataContractSpecification: 0.9.3
id: ecommerce-order-events-v1
info:
  title: E-commerce Order Events
  version: 1.2.0
  description: |
    Real-time order processing event stream for the e-commerce platform.
    Captures all order lifecycle events from creation to fulfillment.
  owner: Platform Team
  contact:
    name: Data Platform Team
    email: data-platform@ecommerce.example.com
    url: https://wiki.ecommerce.example.com/data-contracts/orders
  status: active
  tags:
    - orders
    - events
    - ecommerce
    - real-time
servers:
  production:
    type: kafka
    host: kafka.prod.ecommerce.example.com
    port: 9092
    format: avro
    topic: ecommerce.orders.events.v1
    description: Production Kafka cluster
    environment: production
    security:
      protocol: SASL_SSL
      saslMechanism: PLAIN
  staging:
    type: kafka
    host: kafka.staging.ecommerce.example.com
    port: 9092
    format: avro
    topic: ecommerce.orders.events.v1
    description: Staging Kafka cluster
    environment: staging
terms:
  usage: |
    This event stream contains PII and must be handled according to
    GDPR and CCPA compliance requirements. Data retention is 90 days.
  limitations: |
    Maximum message size: 1MB
    Rate limit: 10,000 events/second
    Replay window: 7 days
  billing: |
    Charged per 1M events consumed.
    Standard tier: $0.50 per 1M events
    Premium tier: $1.00 per 1M events with guaranteed ordering
  noticePeriod: 30 days
models:
  order_created:
    type: object
    description: Event emitted when a new order is created
    fields:
      event_id:
        type: string
        format: uuid
        required: true
        unique: true
        description: Unique identifier for this event
        example: "550e8400-e29b-41d4-a716-446655440000"
        tags:
          - event-metadata
      event_timestamp:
        type: timestamp
        required: true
        description: UTC timestamp when event was generated
        format: iso8601
        example: "2024-03-15T14:30:00.000Z"
        tags:
          - event-metadata
      event_version:
        type: string
        required: true
        description: Schema version for this event type
        pattern: "^\\d+\\.\\d+\\.\\d+$"
        example: "1.2.0"
      order_id:
        type: string
        required: true
        unique: true
        description: Unique order identifier
        pattern: "^ORD-\\d{4}-\\d{5}$"
        example: "ORD-2024-12345"
        tags:
          - business-key
          - pii
        classification: sensitive
      customer_id:
        type: string
        required: true
        description: Customer unique identifier
        pattern: "^CUST-\\d{5}$"
        example: "CUST-98765"
        tags:
          - pii
        classification: confidential
      order_date:
        type: timestamp
        required: true
        description: When the order was placed
        format: iso8601
      total_amount:
        type: decimal
        required: true
        description: Total order amount
        precision: 10
        scale: 2
        minimum: 0
        example: 1234.56
      currency:
        type: string
        required: true
        description: ISO 4217 currency code
        pattern: "^[A-Z]{3}$"
        enum:
          - USD
          - EUR
          - GBP
          - JPY
          - CAD
        example: "USD"
      items:
        type: array
        required: true
        minItems: 1
        maxItems: 100
        description: Ordered items
        items:
          type: object
          fields:
            item_id:
              type: string
              required: true
              description: Product SKU
              example: "SKU-LAPTOP-001"
            item_name:
              type: string
              required: true
              maxLength: 255
              description: Product name
              example: "MacBook Pro 16-inch M3"
            quantity:
              type: integer
              required: true
              minimum: 1
              maximum: 999
              description: Quantity ordered
              example: 2
            unit_price:
              type: decimal
              required: true
              precision: 10
              scale: 2
              description: Price per unit
              example: 2499.99
            discount_percent:
              type: decimal
              required: false
              precision: 5
              scale: 2
              minimum: 0
              maximum: 100
              description: Discount percentage
              example: 10.5
            tax_amount:
              type: decimal
              required: true
              precision: 10
              scale: 2
              description: Tax amount for this line
              example: 249.99
      shipping_address:
        type: object
        required: true
        description: Delivery address
        tags:
          - pii
        classification: confidential
        fields:
          street:
            type: string
            required: true
            maxLength: 200
            example: "1600 Pennsylvania Avenue NW"
          city:
            type: string
            required: true
            maxLength: 100
            example: "Washington"
          state:
            type: string
            required: true
            maxLength: 50
            example: "DC"
          postal_code:
            type: string
            required: true
            pattern: "^\\d{5}(-\\d{4})?$"
            example: "20500"
          country:
            type: string
            required: true
            pattern: "^[A-Z]{2}$"
            example: "US"
      payment_method:
        type: string
        required: true
        description: Payment method used
        enum:
          - credit_card
          - debit_card
          - paypal
          - bank_transfer
          - crypto
        example: "credit_card"
      metadata:
        type: object
        required: false
        description: Additional metadata
        fields:
          source_channel:
            type: string
            enum:
              - web
              - mobile_app
              - api
              - phone
            example: "web"
          user_agent:
            type: string
            maxLength: 500
            example: "Mozilla/5.0..."
          ip_address:
            type: string
            format: ipv4
            example: "192.168.1.1"
            tags:
              - pii
          session_id:
            type: string
            format: uuid
            example: "a1b2c3d4-e5f6-4a5b-8c9d-0e1f2a3b4c5d"
quality:
  type: SLI
  specification:
    freshness:
      description: Events should be published within 5 seconds of order creation
      target: 99.9%
      threshold: 5s
    completeness:
      description: All required fields must be populated
      target: 100%
    accuracy:
      description: Order amounts must match source system
      target: 99.99%
    consistency:
      description: Event ordering must be preserved per order_id
      target: 100%
    availability:
      description: Stream should be available for consumption
      target: 99.95%
    latency:
      description: End-to-end event delivery latency
      p50: 100ms
      p95: 500ms
      p99: 1000ms
schema:
  type: avro
  specification: |
    {
      "type": "record",
      "name": "OrderCreated",
      "namespace": "com.ecommerce.events",
      "fields": [
        {"name": "event_id", "type": "string"},
        {"name": "event_timestamp", "type": "long"},
        {"name": "order_id", "type": "string"},
        {"name": "customer_id", "type": "string"},
        {"name": "total_amount", "type": "double"}
      ]
    }
examples:
  - type: order_created
    description: Typical single-item order
    model: order_created
    data:
      event_id: "550e8400-e29b-41d4-a716-446655440000"
      event_timestamp: "2024-03-15T14:30:00.000Z"
      event_version: "1.2.0"
      order_id: "ORD-2024-12345"
      customer_id: "CUST-98765"
      order_date: "2024-03-15T14:29:55.000Z"
      total_amount: 2749.98
      currency: "USD"
      items:
        - item_id: "SKU-LAPTOP-001"
          item_name: "MacBook Pro 16-inch M3"
          quantity: 1
          unit_price: 2499.99
          discount_percent: 0
          tax_amount: 249.99
      shipping_address:
        street: "123 Main St"
        city: "San Francisco"
        state: "CA"
        postal_code: "94105"
        country: "US"
      payment_method: "credit_card"
      metadata:
        source_channel: "web"
        ip_address: "192.168.1.100"
