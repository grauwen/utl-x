name: JSON-RPC Error Handling
description: Verify proper JSON-RPC 2.0 error responses
tags:
  - protocol
  - json-rpc
  - errors

sequence:
  - description: "Invalid JSON should return parse error"
    method: POST
    endpoint: /mcp
    headers:
      Content-Type: application/json
    body_raw: "{invalid json"
    expect:
      status: 400
      body:
        jsonrpc: "2.0"
        error:
          code: -32700
          message: "{{STRING}}"

  - description: "Missing method should return invalid request error"
    method: POST
    endpoint: /mcp
    headers:
      Content-Type: application/json
    body:
      jsonrpc: "2.0"
      id: 2
      params: {}
    expect:
      status: 200
      body:
        jsonrpc: "2.0"
        id: 2
        error:
          code: -32600
          message: "{{STRING}}"

  - description: "Unknown method should return method not found error"
    method: POST
    endpoint: /mcp
    headers:
      Content-Type: application/json
    body:
      jsonrpc: "2.0"
      id: 3
      method: unknown/method
      params: {}
    expect:
      status: 200
      body:
        jsonrpc: "2.0"
        id: 3
        error:
          code: -32601
          message: "{{STRING}}"
