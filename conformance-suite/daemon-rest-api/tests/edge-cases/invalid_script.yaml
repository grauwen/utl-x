name: Invalid Script Handling
description: Test proper error handling for invalid scripts
tags:
  - edge-cases
  - errors
  - validation

sequence:
  - description: "Missing utlx parameter should return error"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      input: "{\"name\":\"John\"}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 500
      body:
        error: "{{STRING}}"
        message: "{{STRING}}"

  - description: "Empty script should return error"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: ""
      input: "{\"name\":\"John\"}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 400
      body:
        success: false
        error: "{{STRING}}"
        executionTimeMs: "{{NUMBER}}"

  - description: "Malformed script header should return error"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "invalid header\n---\n$input"
      input: "{\"name\":\"John\"}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 400
      body:
        success: false
        error: "{{STRING}}"
        executionTimeMs: "{{NUMBER}}"
