name: Execute Transformations
description: Test /api/execute with various transformation scenarios
tags:
  - endpoints
  - execute
  - transformations

sequence:
  - description: "Execute field extraction"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ name: $input.user.name, email: $input.user.email }"
      input: "{\"user\":{\"name\":\"Alice\",\"email\":\"alice@example.com\",\"password\":\"secret\"}}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"

  - description: "Execute array mapping"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n$input"
      input: "[1,2,3,4,5]"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"

  - description: "Execute object merging"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ id: $input.id, combined: { name: $input.name, age: $input.age, city: \"Unknown\" } }"
      input: "{\"id\":123,\"name\":\"Bob\",\"age\":28}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"

  - description: "Execute string concatenation"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ greeting: \"Hello, \" + $input.name + \"!\" }"
      input: "{\"name\":\"Charlie\"}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"

  - description: "Execute with empty input"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ result: \"empty\" }"
      input: "{}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"
