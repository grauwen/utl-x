name: Validate Then Transform
description: Test workflow of validating a script before transforming data
tags:
  - workflows
  - validate
  - transform
  - multi-step

sequence:
  - description: "Step 1: Validate the script"
    method: POST
    endpoint: /api/validate
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ name: $input.name, age: $input.age + 1 }"
    expect:
      status: 200
      body:
        valid: true
        diagnostics: []

  - description: "Step 2: Transform data using the validated script"
    method: POST
    endpoint: /api/execute
    headers:
      Content-Type: application/json
    body:
      utlx: "%utlx 1.0\ninput json\noutput json\n---\n{ name: $input.name, age: $input.age + 1 }"
      input: "{\"name\":\"Alice\",\"age\":25}"
      inputFormat: "json"
      outputFormat: "json"
    expect:
      status: 200
      body:
        success: true
        output: "{{JSON}}"
        executionTimeMs: "{{NUMBER}}"
