# Test: USDL to JSON Schema with multiple types
# Verifies multiple type definitions in %types object

description: "Generate JSON Schema with multiple definitions from USDL"

transformation: |
  %utlx 1.0
  input json
  output jsch
  ---
  {
    "%types": {
      Customer: {
        "%kind": "structure",
        "%fields": [
          {
            "%name": "id",
            "%type": "string",
            "%required": true
          }
        ]
      },
      Order: {
        "%kind": "structure",
        "%fields": [
          {
            "%name": "orderId",
            "%type": "string",
            "%required": true
          }
        ]
      }
    }
  }

input:
  format: json
  data: |
      {}

expected:
  format: json
  data: |
      {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$defs": {
          "Customer": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              }
            },
            "required": ["id"]
          },
          "Order": {
            "type": "object",
            "properties": {
              "orderId": {
                "type": "string"
              }
            },
            "required": ["orderId"]
          }
        }
      }
